
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="a framework for Automated Classification of Medical Images">
      
      
        <meta name="author" content="University Augsburg">
      
      
        <link rel="canonical" href="https://frankkramer-lab.github.io/aucmedi/reference/ensemble/composite/">
      
      
        <link rel="prev" href="../bagging/">
      
      
        <link rel="next" href="../stacking/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Composite - AUCMEDI</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/progressbar.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#aucmedi.ensemble.composite" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="AUCMEDI" class="md-header__button md-logo" aria-label="AUCMEDI" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7.5 4A5.5 5.5 0 0 0 2 9.5c0 .5.09 1 .22 1.5H6.3l1.27-3.37c.3-.8 1.48-.88 1.86 0L11.5 13l.59-1.42c.13-.33.48-.58.91-.58h8.78c.13-.5.22-1 .22-1.5A5.5 5.5 0 0 0 16.5 4c-1.86 0-3.5.93-4.5 2.34C11 4.93 9.36 4 7.5 4M3 12.5a1 1 0 0 0-1 1 1 1 0 0 0 1 1h2.44L11 20c1 .9 1 .9 2 0l5.56-5.5H21a1 1 0 0 0 1-1 1 1 0 0 0-1-1h-7.6l-.93 2.3c-.4 1.01-1.55.87-1.92.03L8.5 9.5l-.96 2.33c-.15.38-.49.67-.94.67z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AUCMEDI
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Composite
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/frankkramer-lab/aucmedi" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    frankkramer-lab/aucmedi
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../workflow/" class="md-tabs__link">
        
  
  
    
  
  Workflow

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../getstarted/intro/" class="md-tabs__link">
          
  
  
    
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../examples/framework/" class="md-tabs__link">
          
  
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../automl/overview/" class="md-tabs__link">
          
  
  
    
  
  AutoML

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="../../" class="md-tabs__link">
        
  
  
    
  
  API Reference

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../about/" class="md-tabs__link">
        
  
  
    
  
  About Us

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="AUCMEDI" class="md-nav__button md-logo" aria-label="AUCMEDI" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7.5 4A5.5 5.5 0 0 0 2 9.5c0 .5.09 1 .22 1.5H6.3l1.27-3.37c.3-.8 1.48-.88 1.86 0L11.5 13l.59-1.42c.13-.33.48-.58.91-.58h8.78c.13-.5.22-1 .22-1.5A5.5 5.5 0 0 0 16.5 4c-1.86 0-3.5.93-4.5 2.34C11 4.93 9.36 4 7.5 4M3 12.5a1 1 0 0 0-1 1 1 1 0 0 0 1 1h2.44L11 20c1 .9 1 .9 2 0l5.56-5.5H21a1 1 0 0 0 1-1 1 1 0 0 0-1-1h-7.6l-.93 2.3c-.4 1.01-1.55.87-1.92.03L8.5 9.5l-.96 2.33c-.15.38-.49.67-.94.67z"/></svg>

    </a>
    AUCMEDI
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/frankkramer-lab/aucmedi" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    frankkramer-lab/aucmedi
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Workflow
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getstarted/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getstarted/status/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Current Status
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getstarted/setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getstarted/modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getstarted/usage_api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick Start - Framework
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getstarted/usage_automl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick Start - AutoML
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getstarted/contribution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getstarted/cite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to cite
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/framework/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Framework
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/automl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AutoML
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/tutorials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/applications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Applications
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    AutoML
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            AutoML
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../automl/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../automl/dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dataset Structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../automl/parameters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parameters
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Command Line Interface
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            Command Line Interface
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../automl/cli/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../automl/cli/usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            Docker
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../automl/docker/intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../automl/docker/usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../automl/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Automl
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            Automl
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../automl/block_eval/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Block eval
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../automl/block_pred/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Block pred
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../automl/block_train/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Block train
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../automl/cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cli
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../automl/main/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Main
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../automl/parser_cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parser cli
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../automl/parser_yaml/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parser yaml
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../data_processing/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Data processing
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            Data processing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_processing/data_generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data generator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_processing/io_data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Io data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../data_processing/augmentation/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Augmentation
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_2_3" id="__nav_6_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2_3">
            <span class="md-nav__icon md-icon"></span>
            Augmentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_processing/augmentation/aug_batchgenerators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Aug batchgenerators
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_processing/augmentation/aug_image/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Aug image
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_processing/augmentation/aug_volume/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Aug volume
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../data_processing/io_interfaces/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Io interfaces
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_2_4" id="__nav_6_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2_4">
            <span class="md-nav__icon md-icon"></span>
            Io interfaces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_processing/io_interfaces/io_csv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Io csv
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_processing/io_interfaces/io_directory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Io directory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_processing/io_interfaces/io_json/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Io json
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../data_processing/io_loader/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Io loader
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_2_5" id="__nav_6_2_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2_5">
            <span class="md-nav__icon md-icon"></span>
            Io loader
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_processing/io_loader/cache_loader/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cache loader
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_processing/io_loader/image_loader/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Image loader
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_processing/io_loader/numpy_loader/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Numpy loader
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_processing/io_loader/sitk_loader/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sitk loader
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../data_processing/subfunctions/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Subfunctions
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_2_6" id="__nav_6_2_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2_6">
            <span class="md-nav__icon md-icon"></span>
            Subfunctions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_processing/subfunctions/chromer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chromer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_processing/subfunctions/clip/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Clip
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_processing/subfunctions/color_constancy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Color constancy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_processing/subfunctions/crop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Crop
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_processing/subfunctions/padding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Padding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_processing/subfunctions/resize/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resize
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_processing/subfunctions/sf_base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sf base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_processing/subfunctions/standardize/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Standardize
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Ensemble
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            Ensemble
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../augmenting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Augmenting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bagging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bagging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Composite
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Composite
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#aucmedi.ensemble.composite" class="md-nav__link">
    <span class="md-ellipsis">
      aucmedi.ensemble.composite
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aucmedi.ensemble.composite.Composite" class="md-nav__link">
    <span class="md-ellipsis">
      Composite
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Composite">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aucmedi.ensemble.composite.Composite.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aucmedi.ensemble.composite.Composite.dump" class="md-nav__link">
    <span class="md-ellipsis">
      dump()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aucmedi.ensemble.composite.Composite.load" class="md-nav__link">
    <span class="md-ellipsis">
      load()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aucmedi.ensemble.composite.Composite.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aucmedi.ensemble.composite.Composite.train" class="md-nav__link">
    <span class="md-ellipsis">
      train()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aucmedi.ensemble.composite.Composite.train_metalearner" class="md-nav__link">
    <span class="md-ellipsis">
      train_metalearner()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stacking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stacking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../aggregate/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Aggregate
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_3_5" id="__nav_6_3_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3_5">
            <span class="md-nav__icon md-icon"></span>
            Aggregate
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aggregate/agg_base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agg base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aggregate/averaging_mean/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Averaging mean
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aggregate/averaging_median/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Averaging median
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aggregate/global_argmax/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Global argmax
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aggregate/majority_vote/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Majority vote
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aggregate/softmax/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Softmax
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../metalearner/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Metalearner
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_3_6" id="__nav_6_3_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3_6">
            <span class="md-nav__icon md-icon"></span>
            Metalearner
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metalearner/averaging_mean_weighted/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Averaging mean weighted
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metalearner/best_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Best model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metalearner/decision_tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decision tree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metalearner/gaussian_process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gaussian process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metalearner/k_neighbors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    K neighbors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metalearner/logistic_regression/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logistic regression
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metalearner/ml_base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ml base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metalearner/mlp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mlp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metalearner/naive_bayes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Naive bayes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metalearner/random_forest/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Random forest
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metalearner/support_vector_machine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Support vector machine
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../evaluation/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Evaluation
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            Evaluation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Comparison
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dataset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/fitting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fitting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../evaluation/performance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performance
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../neural_network/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Neural network
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_5" id="__nav_6_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5">
            <span class="md-nav__icon md-icon"></span>
            Neural network
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/loss_functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Loss functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../neural_network/architectures/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Architectures
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_5_3" id="__nav_6_5_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5_3">
            <span class="md-nav__icon md-icon"></span>
            Architectures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/arch_base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Arch base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/classifier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Classifier
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5_3_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../neural_network/architectures/image/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Image
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_5_3_3" id="__nav_6_5_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_5_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5_3_3">
            <span class="md-nav__icon md-icon"></span>
            Image
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/convnext_base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Convnext base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/convnext_large/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Convnext large
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/convnext_small/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Convnext small
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/convnext_tiny/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Convnext tiny
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/densenet121/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Densenet121
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/densenet169/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Densenet169
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/densenet201/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Densenet201
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/efficientnetb0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Efficientnetb0
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/efficientnetb1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Efficientnetb1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/efficientnetb2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Efficientnetb2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/efficientnetb3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Efficientnetb3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/efficientnetb4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Efficientnetb4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/efficientnetb5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Efficientnetb5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/efficientnetb6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Efficientnetb6
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/efficientnetb7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Efficientnetb7
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/inceptionresnetv2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inceptionresnetv2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/inceptionv3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inceptionv3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/mobilenet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mobilenet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/mobilenetv2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mobilenetv2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/nasnetlarge/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nasnetlarge
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/nasnetmobile/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nasnetmobile
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/resnet101/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resnet101
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/resnet101v2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resnet101v2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/resnet152/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resnet152
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/resnet152v2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resnet152v2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/resnet50/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resnet50
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/resnet50v2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resnet50v2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/resnext101/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resnext101
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/resnext50/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resnext50
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/vanilla/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vanilla
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/vgg16/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vgg16
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/vgg19/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vgg19
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/vit_b16/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vit b16
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/vit_b32/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vit b32
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/vit_l16/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vit l16
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/vit_l32/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vit l32
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/image/xception/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Xception
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5_3_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../neural_network/architectures/volume/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Volume
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_5_3_4" id="__nav_6_5_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_6_5_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5_3_4">
            <span class="md-nav__icon md-icon"></span>
            Volume
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/volume/convnext_base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Convnext base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/volume/convnext_large/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Convnext large
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/volume/convnext_small/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Convnext small
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/volume/convnext_tiny/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Convnext tiny
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/volume/densenet121/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Densenet121
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/volume/densenet169/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Densenet169
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/volume/densenet201/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Densenet201
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/volume/mobilenet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mobilenet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/volume/mobilenetv2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mobilenetv2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/volume/resnet101/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resnet101
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/volume/resnet152/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resnet152
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/volume/resnet18/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resnet18
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/volume/resnet34/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resnet34
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/volume/resnet50/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resnet50
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/volume/resnext101/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resnext101
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/volume/resnext50/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resnext50
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/volume/vanilla/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vanilla
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/volume/vgg16/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vgg16
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../neural_network/architectures/volume/vgg19/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vgg19
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../sampling/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Sampling
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_6" id="__nav_6_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_6">
            <span class="md-nav__icon md-icon"></span>
            Sampling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sampling/iterative/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Iterative
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sampling/kfold/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kfold
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sampling/split/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Split
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../utils/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_7" id="__nav_6_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_7">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/callbacks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Callbacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/class_weights/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Class weights
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/visualizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visualizer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../xai/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Xai
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_8" id="__nav_6_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_8">
            <span class="md-nav__icon md-icon"></span>
            Xai
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../xai/decoder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decoder
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_8_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../xai/methods/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Methods
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_8_2" id="__nav_6_8_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_6_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_8_2">
            <span class="md-nav__icon md-icon"></span>
            Methods
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../xai/methods/gradcam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gradcam
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../xai/methods/gradcam_guided/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gradcam guided
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../xai/methods/gradcam_pp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gradcam pp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../xai/methods/guided_backprop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guided backprop
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../xai/methods/integrated_gradients/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Integrated gradients
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../xai/methods/lime_con/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lime con
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../xai/methods/lime_pro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lime pro
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../xai/methods/occlusion_sensitivity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Occlusion sensitivity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../xai/methods/saliency/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Saliency
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../xai/methods/xai_base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Xai base
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About Us
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#aucmedi.ensemble.composite" class="md-nav__link">
    <span class="md-ellipsis">
      aucmedi.ensemble.composite
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aucmedi.ensemble.composite.Composite" class="md-nav__link">
    <span class="md-ellipsis">
      Composite
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Composite">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aucmedi.ensemble.composite.Composite.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aucmedi.ensemble.composite.Composite.dump" class="md-nav__link">
    <span class="md-ellipsis">
      dump()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aucmedi.ensemble.composite.Composite.load" class="md-nav__link">
    <span class="md-ellipsis">
      load()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aucmedi.ensemble.composite.Composite.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aucmedi.ensemble.composite.Composite.train" class="md-nav__link">
    <span class="md-ellipsis">
      train()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aucmedi.ensemble.composite.Composite.train_metalearner" class="md-nav__link">
    <span class="md-ellipsis">
      train_metalearner()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Composite</h1>

<div class="doc doc-object doc-module">


<a id="aucmedi.ensemble.composite"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="aucmedi.ensemble.composite.Composite" class="doc doc-heading">
        <code>Composite</code>


<a href="#aucmedi.ensemble.composite.Composite" class="headerlink" title="Permanent link">¤</a></h2>


  <div class="doc doc-contents ">

  
      <p>A Composite class providing functionality for cross-validation and metalearner based ensemble learning.</p>
<p>The Composite strategy combines the homogeneous <a class="autorefs autorefs-internal" href="../bagging/#aucmedi.ensemble.bagging.Bagging">Bagging</a> and the heterogeneous
<a class="autorefs autorefs-internal" href="../stacking/#aucmedi.ensemble.stacking.Stacking">Stacking</a> technique.</p>
<p>If a metalearner is selected, a percentage sampling split is applied. For an aggregate function, this is not done.
The remaining training data is sampled via a cross-validation. For each fold, a different model is trained
returning into a heterogenous ensemble.
Predictions for this heterogenous ensemble are combined with the fitted metalearner model or an aggregate function.</p>
<p>Instead of utilizing the fixed parameters of the <a class="autorefs autorefs-internal" href="../../data_processing/data_generator/#aucmedi.data_processing.data_generator">DataGenerator</a>,
default paramters for Resizing and Standardize of the associated models are used (if <code>fixed_datagenerator=True</code>).</p>
<details class="example" open="open">
<summary>Example</summary>
<div class="highlight"><pre><span></span><code><span class="c1"># Initialize some NeuralNetwork models</span>
<span class="n">model_a</span> <span class="o">=</span> <span class="n">NeuralNetwork</span><span class="p">(</span><span class="n">n_labels</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">architecture</span><span class="o">=</span><span class="s2">&quot;2D.ResNet50&quot;</span><span class="p">)</span>
<span class="n">model_b</span> <span class="o">=</span> <span class="n">NeuralNetwork</span><span class="p">(</span><span class="n">n_labels</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">architecture</span><span class="o">=</span><span class="s2">&quot;2D.MobileNetV2&quot;</span><span class="p">)</span>
<span class="n">model_c</span> <span class="o">=</span> <span class="n">NeuralNetwork</span><span class="p">(</span><span class="n">n_labels</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">architecture</span><span class="o">=</span><span class="s2">&quot;2D.EfficientNetB1&quot;</span><span class="p">)</span>

<span class="c1"># Initialize Composite object</span>
<span class="n">el</span> <span class="o">=</span> <span class="n">Composite</span><span class="p">(</span><span class="n">model_list</span><span class="o">=</span><span class="p">[</span><span class="n">model_a</span><span class="p">,</span> <span class="n">model_b</span><span class="p">,</span> <span class="n">model_c</span><span class="p">],</span>
               <span class="n">metalearner</span><span class="o">=</span><span class="s2">&quot;logistic_regression&quot;</span><span class="p">,</span> <span class="n">k_fold</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Initialize training DataGenerator for complete training data</span>
<span class="n">datagen</span> <span class="o">=</span> <span class="n">DataGenerator</span><span class="p">(</span><span class="n">samples_train</span><span class="p">,</span> <span class="s2">&quot;images_dir/&quot;</span><span class="p">,</span>
                        <span class="n">labels</span><span class="o">=</span><span class="n">train_labels_ohe</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                        <span class="n">resize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">standardize_mode</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="c1"># Train neural network and metalearner models</span>
<span class="n">el</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">datagen</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Initialize testing DataGenerator for testing data</span>
<span class="n">test_gen</span> <span class="o">=</span> <span class="n">DataGenerator</span><span class="p">(</span><span class="n">samples_test</span><span class="p">,</span> <span class="s2">&quot;images_dir/&quot;</span><span class="p">,</span>
                         <span class="n">resize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">standardize_mode</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="c1"># Run Inference</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">el</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_gen</span><span class="p">)</span>
</code></pre></div>
</details>
<div class="admonition warning">
<p class="admonition-title">Training Time Increase</p>
<p>Composite sequentially performs fitting processes for multiple models, which will drastically increase training time.</p>
</div>
<details class="warning">
<summary>DataGenerator re-initialization</summary>
<p>The passed DataGenerator for the train() and predict() function of the Composite class will be re-initialized!</p>
<p>This can result in redundant image preparation if <code>prepare_images=True</code>.</p>
<p>Furthermore, the parameters <code>resize</code> and <code>standardize_mode</code> are automatically re-initialized with
NeuralNetwork model specific values (<code>model.meta_standardize</code> for <code>standardize_mode</code> and
<code>model.meta_input</code> for <code>input_shape</code>).</p>
<p>If desired (but not recommended!), it is possible to modify the meta variables of the NeuralNetwork model as follows:
<div class="highlight"><pre><span></span><code><span class="c1"># For input_shape</span>
<span class="n">model_a</span> <span class="o">=</span> <span class="n">NeuralNetwork</span><span class="p">(</span><span class="n">n_labels</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">architecture</span><span class="o">=</span><span class="s2">&quot;2D.ResNet50&quot;</span><span class="p">,</span>
                        <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span><span class="mi">64</span><span class="p">))</span>
<span class="c1"># For standardize_mode</span>
<span class="n">model_b</span> <span class="o">=</span> <span class="n">NeuralNetwork</span><span class="p">(</span><span class="n">n_labels</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">channels</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">architecture</span><span class="o">=</span><span class="s2">&quot;2D.MobileNetV2&quot;</span><span class="p">)</span>
<span class="n">model_b</span><span class="o">.</span><span class="n">meta_standardize</span> <span class="o">=</span> <span class="s2">&quot;torch&quot;</span>
</code></pre></div></p>
</details>
<details class="warning">
<summary>NeuralNetwork re-initialization</summary>
<p>The passed NeuralNetwork for the train() and predict() function of the Composite class will be re-initialized!</p>
<p>Attention: Metrics are not passed to the processes due to pickling issues.</p>
</details>
<details class="info">
<summary>Technical Details</summary>
<p>For the training and inference process, each model will create an individual process via the Python multiprocessing package.</p>
<p>This is crucial as TensorFlow does not fully support the VRAM memory garbage collection in GPUs,
which is why more and more redundant data pile up with an increasing number of models.</p>
<p>Via separate processes, it is possible to clean up the TensorFlow environment and rebuild it again for the next model.</p>
</details>


        <details class="quote">
          <summary>Source code in <code>aucmedi/ensemble/composite.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Composite</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; A Composite class providing functionality for cross-validation and metalearner based ensemble learning.</span>

<span class="sd">    The Composite strategy combines the homogeneous [Bagging][aucmedi.ensemble.Bagging] and the heterogeneous</span>
<span class="sd">    [Stacking][aucmedi.ensemble.Stacking] technique.</span>

<span class="sd">    If a metalearner is selected, a percentage sampling split is applied. For an aggregate function, this is not done.</span>
<span class="sd">    The remaining training data is sampled via a cross-validation. For each fold, a different model is trained</span>
<span class="sd">    returning into a heterogenous ensemble.</span>
<span class="sd">    Predictions for this heterogenous ensemble are combined with the fitted metalearner model or an aggregate function.</span>

<span class="sd">    Instead of utilizing the fixed parameters of the [DataGenerator][aucmedi.data_processing.data_generator],</span>
<span class="sd">    default paramters for Resizing and Standardize of the associated models are used (if `fixed_datagenerator=True`).</span>

<span class="sd">    ???+ example</span>
<span class="sd">        ```python</span>
<span class="sd">        # Initialize some NeuralNetwork models</span>
<span class="sd">        model_a = NeuralNetwork(n_labels=4, channels=3, architecture=&quot;2D.ResNet50&quot;)</span>
<span class="sd">        model_b = NeuralNetwork(n_labels=4, channels=3, architecture=&quot;2D.MobileNetV2&quot;)</span>
<span class="sd">        model_c = NeuralNetwork(n_labels=4, channels=3, architecture=&quot;2D.EfficientNetB1&quot;)</span>

<span class="sd">        # Initialize Composite object</span>
<span class="sd">        el = Composite(model_list=[model_a, model_b, model_c],</span>
<span class="sd">                       metalearner=&quot;logistic_regression&quot;, k_fold=3)</span>

<span class="sd">        # Initialize training DataGenerator for complete training data</span>
<span class="sd">        datagen = DataGenerator(samples_train, &quot;images_dir/&quot;,</span>
<span class="sd">                                labels=train_labels_ohe, batch_size=3,</span>
<span class="sd">                                resize=None, standardize_mode=None)</span>
<span class="sd">        # Train neural network and metalearner models</span>
<span class="sd">        el.train(datagen, epochs=100)</span>

<span class="sd">        # Initialize testing DataGenerator for testing data</span>
<span class="sd">        test_gen = DataGenerator(samples_test, &quot;images_dir/&quot;,</span>
<span class="sd">                                 resize=None, standardize_mode=None)</span>
<span class="sd">        # Run Inference</span>
<span class="sd">        preds = el.predict(test_gen)</span>
<span class="sd">        ```</span>

<span class="sd">    !!! warning &quot;Training Time Increase&quot;</span>
<span class="sd">        Composite sequentially performs fitting processes for multiple models, which will drastically increase training time.</span>

<span class="sd">    ??? warning &quot;DataGenerator re-initialization&quot;</span>
<span class="sd">        The passed DataGenerator for the train() and predict() function of the Composite class will be re-initialized!</span>

<span class="sd">        This can result in redundant image preparation if `prepare_images=True`.</span>

<span class="sd">        Furthermore, the parameters `resize` and `standardize_mode` are automatically re-initialized with</span>
<span class="sd">        NeuralNetwork model specific values (`model.meta_standardize` for `standardize_mode` and</span>
<span class="sd">        `model.meta_input` for `input_shape`).</span>

<span class="sd">        If desired (but not recommended!), it is possible to modify the meta variables of the NeuralNetwork model as follows:</span>
<span class="sd">        ```python</span>
<span class="sd">        # For input_shape</span>
<span class="sd">        model_a = NeuralNetwork(n_labels=4, channels=3, architecture=&quot;2D.ResNet50&quot;,</span>
<span class="sd">                                input_shape=(64,64))</span>
<span class="sd">        # For standardize_mode</span>
<span class="sd">        model_b = NeuralNetwork(n_labels=4, channels=3, architecture=&quot;2D.MobileNetV2&quot;)</span>
<span class="sd">        model_b.meta_standardize = &quot;torch&quot;</span>
<span class="sd">        ```</span>

<span class="sd">    ??? warning &quot;NeuralNetwork re-initialization&quot;</span>
<span class="sd">        The passed NeuralNetwork for the train() and predict() function of the Composite class will be re-initialized!</span>

<span class="sd">        Attention: Metrics are not passed to the processes due to pickling issues.</span>

<span class="sd">    ??? info &quot;Technical Details&quot;</span>
<span class="sd">        For the training and inference process, each model will create an individual process via the Python multiprocessing package.</span>

<span class="sd">        This is crucial as TensorFlow does not fully support the VRAM memory garbage collection in GPUs,</span>
<span class="sd">        which is why more and more redundant data pile up with an increasing number of models.</span>

<span class="sd">        Via separate processes, it is possible to clean up the TensorFlow environment and rebuild it again for the next model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_list</span><span class="p">,</span> <span class="n">metalearner</span><span class="o">=</span><span class="s2">&quot;logistic_regression&quot;</span><span class="p">,</span>
                 <span class="n">k_fold</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="p">[</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">],</span> <span class="n">fixed_datagenerator</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Initialization function for creating a Composite object.</span>

<span class="sd">        Args:</span>
<span class="sd">            model_list (list of NeuralNetwork):         List of instances of AUCMEDI neural network class.</span>
<span class="sd">                                                        The number of models (`len(model_list)`) have to be equal to `k_fold`.</span>
<span class="sd">            metalearner (str, Metalearner or Aggregate):Metalearner class instance / a string for an AUCMEDI Metalearner,</span>
<span class="sd">                                                        or Aggregate function / a string for an AUCMEDI Aggregate function.</span>
<span class="sd">            k_fold (int):                               Number of folds (k) for the Cross-Validation. Must be at least 2.</span>
<span class="sd">            sampling (list of float):                   List of percentage values with split sizes. Should be 2x percentage values</span>
<span class="sd">                                                        for heterogenous metalearner (must sum up to 1.0).</span>
<span class="sd">            fixed_datagenerator (bool):                 Boolean, whether using fixed parameters of passed DataGenerator or</span>
<span class="sd">                                                        using default architecture paramters for Resizing and Standardize.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Cache class variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span> <span class="o">=</span> <span class="n">model_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metalearner</span> <span class="o">=</span> <span class="n">metalearner</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sampling</span> <span class="o">=</span> <span class="n">sampling</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_fold</span> <span class="o">=</span> <span class="n">k_fold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fixed_datagenerator</span> <span class="o">=</span> <span class="n">fixed_datagenerator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sampling_seed</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Initialize Metalearner</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metalearner</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">metalearner</span> <span class="ow">in</span> <span class="n">metalearner_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span> <span class="o">=</span> <span class="n">metalearner_dict</span><span class="p">[</span><span class="n">metalearner</span><span class="p">]()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metalearner</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">metalearner</span> <span class="ow">in</span> <span class="n">aggregate_dict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span> <span class="o">=</span> <span class="n">aggregate_dict</span><span class="p">[</span><span class="n">metalearner</span><span class="p">]()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metalearner</span><span class="p">,</span> <span class="n">Metalearner_Base</span><span class="p">)</span> <span class="ow">or</span> \
             <span class="nb">isinstance</span><span class="p">(</span><span class="n">metalearner</span><span class="p">,</span> <span class="n">Aggregate_Base</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span> <span class="o">=</span> <span class="n">metalearner</span>
        <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unknown type of Metalearner (neither known &quot;</span> <span class="o">+</span> \
                               <span class="s2">&quot;ensembler nor Aggregate or Metalearner class)!&quot;</span><span class="p">)</span>

        <span class="c1"># Verify model list length</span>
        <span class="k">if</span> <span class="n">k_fold</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Length of model_list and k_fold has to be equal!&quot;</span><span class="p">)</span>

        <span class="c1"># Set multiprocessing method to spawn</span>
        <span class="n">mp</span><span class="o">.</span><span class="n">set_start_method</span><span class="p">(</span><span class="s2">&quot;spawn&quot;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">training_generator</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">callbacks</span><span class="o">=</span><span class="p">[],</span> <span class="n">class_weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transfer_learning</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
              <span class="n">metalearner_fitting</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Training function for fitting the provided NeuralNetwork models.</span>

<span class="sd">        The training data will be sampled according to a percentage split in which</span>
<span class="sd">        [DataGenerators][aucmedi.data_processing.data_generator.DataGenerator] for model training</span>
<span class="sd">        and metalearner training if a metalearner is provided. Else all data is used as model</span>
<span class="sd">        training subset. The model training subset is furthermore sampled via cross-validation.</span>

<span class="sd">        It is also possible to pass custom Callback classes in order to obtain more information.</span>

<span class="sd">        For more information on the fitting process, check out [NeuralNetwork.train()][aucmedi.neural_network.model.NeuralNetwork.train].</span>

<span class="sd">        Args:</span>
<span class="sd">            training_generator (DataGenerator):     A data generator which will be used for training (will be split according</span>
<span class="sd">                                                    to percentage split and k-fold cross-validation sampling).</span>
<span class="sd">            epochs (int):                           Number of epochs. A single epoch is defined as one iteration through</span>
<span class="sd">                                                    the complete data set.</span>
<span class="sd">            iterations (int):                       Number of iterations (batches) in a single epoch.</span>
<span class="sd">            callbacks (list of Callback classes):   A list of Callback classes for custom evaluation.</span>
<span class="sd">            class_weights (dictionary or list):     A list or dictionary of float values to handle class unbalance.</span>
<span class="sd">            transfer_learning (bool):               Option whether a transfer learning training should be performed.</span>
<span class="sd">            metalearner_fitting (bool):             Option whether the Metalearner fitting process should be included in the</span>
<span class="sd">                                                    Composite training process. The `train_metalearner()` function can also be</span>
<span class="sd">                                                    run manually (or repeatedly).</span>
<span class="sd">        Returns:</span>
<span class="sd">            history (dict):                         A history dictionary from a Keras history object which contains several logs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">temp_dg</span> <span class="o">=</span> <span class="n">training_generator</span>    <span class="c1"># Template DataGenerator variable for faster access</span>
        <span class="n">history_composite</span> <span class="o">=</span> <span class="p">{}</span>           <span class="c1"># Final history dictionary</span>

        <span class="c1"># Create temporary model directory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;aucmedi.tmp.&quot;</span><span class="p">,</span>
                                                     <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.composite&quot;</span><span class="p">)</span>

        <span class="c1"># Obtain training data</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">training_generator</span><span class="o">.</span><span class="n">samples</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">training_generator</span><span class="o">.</span><span class="n">labels</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">training_generator</span><span class="o">.</span><span class="n">metadata</span>

        <span class="c1"># Apply percentage split sampling for metalearner</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="p">,</span> <span class="n">Metalearner_Base</span><span class="p">):</span>
            <span class="n">ps_sampling</span> <span class="o">=</span> <span class="n">sampling_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling</span><span class="p">,</span>
                                         <span class="n">stratified</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                         <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_seed</span><span class="p">)</span>
            <span class="c1"># Pack data according to sampling</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ps_sampling</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">ps_sampling</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span> <span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ps_sampling</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Apply cross-validaton sampling</span>
        <span class="n">cv_sampling</span> <span class="o">=</span> <span class="n">sampling_kfold</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">k_fold</span><span class="p">,</span>
                                     <span class="n">stratified</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Sequentially iterate over model list</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">)):</span>
            <span class="c1"># Pack data into a tuple</span>
            <span class="n">fold</span> <span class="o">=</span> <span class="n">cv_sampling</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fold</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">test_x</span><span class="p">,</span> <span class="n">test_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">fold</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">test_x</span><span class="p">,</span> <span class="n">test_y</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span> <span class="n">data</span> <span class="o">=</span> <span class="n">fold</span>

            <span class="c1"># Create model specific callback list</span>
            <span class="n">callbacks_model</span> <span class="o">=</span> <span class="n">callbacks</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="c1"># Extend Callback list</span>
            <span class="n">path_model</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                      <span class="s2">&quot;cv_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.model.keras&quot;</span><span class="p">)</span>
            <span class="n">cb_mc</span> <span class="o">=</span> <span class="n">ModelCheckpoint</span><span class="p">(</span><span class="n">path_model</span><span class="p">,</span>
                                    <span class="n">monitor</span><span class="o">=</span><span class="s2">&quot;val_loss&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                    <span class="n">save_best_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">)</span>
            <span class="n">cb_cl</span> <span class="o">=</span> <span class="n">CSVLogger</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                                 <span class="s2">&quot;cv_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> \
                                                 <span class="s2">&quot;.logs.csv&quot;</span><span class="p">),</span>
                              <span class="n">separator</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">callbacks_model</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">cb_mc</span><span class="p">,</span> <span class="n">cb_cl</span><span class="p">])</span>

            <span class="c1"># Gather NeuralNetwork parameters</span>
            <span class="n">model_paras</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;n_labels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">n_labels</span><span class="p">,</span>
                <span class="s2">&quot;channels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">channels</span><span class="p">,</span>
                <span class="s2">&quot;input_shape&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">input_shape</span><span class="p">,</span>
                <span class="s2">&quot;architecture&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">architecture</span><span class="p">,</span>
                <span class="s2">&quot;pretrained_weights&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">pretrained_weights</span><span class="p">,</span>
                <span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">loss</span><span class="p">,</span>
                <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;activation_output&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">activation_output</span><span class="p">,</span>
                <span class="s2">&quot;fcl_dropout&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fcl_dropout</span><span class="p">,</span>
                <span class="s2">&quot;meta_variables&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">meta_variables</span><span class="p">,</span>
                <span class="s2">&quot;learning_rate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">learning_rate</span><span class="p">,</span>
            <span class="p">}</span>

            <span class="c1"># Gather DataGenerator parameters</span>
            <span class="n">datagen_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;path_imagedir&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">path_imagedir</span><span class="p">,</span>
                             <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span>
                             <span class="s2">&quot;data_aug&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">data_aug</span><span class="p">,</span>
                             <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
                             <span class="s2">&quot;subfunctions&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">subfunctions</span><span class="p">,</span>
                             <span class="s2">&quot;shuffle&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">shuffle</span><span class="p">,</span>
                             <span class="s2">&quot;standardize_mode&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">meta_standardize</span><span class="p">,</span>
                             <span class="s2">&quot;resize&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">meta_input</span><span class="p">,</span>
                             <span class="s2">&quot;grayscale&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">grayscale</span><span class="p">,</span>
                             <span class="s2">&quot;prepare_images&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">prepare_images</span><span class="p">,</span>
                             <span class="s2">&quot;sample_weights&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">sample_weights</span><span class="p">,</span>
                             <span class="s2">&quot;image_format&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">image_format</span><span class="p">,</span>
                             <span class="s2">&quot;loader&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">sample_loader</span><span class="p">,</span>
                             <span class="s2">&quot;workers&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">workers</span><span class="p">,</span>
                             <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">kwargs</span>
            <span class="p">}</span>

            <span class="c1"># Gather training parameters</span>
            <span class="n">parameters_training</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;epochs&quot;</span><span class="p">:</span> <span class="n">epochs</span><span class="p">,</span>
                                <span class="s2">&quot;iterations&quot;</span><span class="p">:</span> <span class="n">iterations</span><span class="p">,</span>
                                <span class="s2">&quot;callbacks&quot;</span><span class="p">:</span> <span class="n">callbacks_model</span><span class="p">,</span>
                                <span class="s2">&quot;class_weights&quot;</span><span class="p">:</span> <span class="n">class_weights</span><span class="p">,</span>
                                <span class="s2">&quot;transfer_learning&quot;</span><span class="p">:</span> <span class="n">transfer_learning</span>
            <span class="p">}</span>

            <span class="c1"># Start training process</span>
            <span class="n">process_queue</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
            <span class="n">process_train</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">__training_process__</span><span class="p">,</span>
                                       <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">process_queue</span><span class="p">,</span>
                                             <span class="n">data</span><span class="p">,</span>
                                             <span class="n">model_paras</span><span class="p">,</span>
                                             <span class="n">datagen_paras</span><span class="p">,</span>
                                             <span class="n">parameters_training</span><span class="p">))</span>
            <span class="n">process_train</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="n">process_train</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">cv_history</span> <span class="o">=</span> <span class="n">process_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="c1"># Combine logged history objects</span>
            <span class="n">hnn</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cv_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">cv_history</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="n">history_composite</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">history_composite</span><span class="p">,</span> <span class="o">**</span><span class="n">hnn</span><span class="p">}</span>

        <span class="c1"># Perform metalearner model training</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="p">,</span> <span class="n">Metalearner_Base</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">train_metalearner</span><span class="p">(</span><span class="n">temp_dg</span><span class="p">)</span>

        <span class="c1"># Return Composite history object</span>
        <span class="k">return</span> <span class="n">history_composite</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">train_metalearner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">training_generator</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Training function for fitting the Metalearner model.</span>

<span class="sd">        Function will be called automatically in the `train()` function if</span>
<span class="sd">        the parameter `metalearner_fitting` is true.</span>

<span class="sd">        However, this function can also be called multiple times for training</span>
<span class="sd">        different Metalearner types without the need of time-extensive</span>
<span class="sd">        re-training of the [NeuralNetwork][aucmedi.neural_network.model] models.</span>

<span class="sd">        Args:</span>
<span class="sd">            training_generator (DataGenerator):     A data generator which will be used for training (will be split according</span>
<span class="sd">                                                    to percentage split).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Skipping metalearner training if aggregate function</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="p">,</span> <span class="n">Aggregate_Base</span><span class="p">)</span> <span class="p">:</span> <span class="k">return</span>

        <span class="n">temp_dg</span> <span class="o">=</span> <span class="n">training_generator</span>    <span class="c1"># Template DataGenerator variable for faster access</span>
        <span class="n">preds_ensemble</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Obtain training data</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">training_generator</span><span class="o">.</span><span class="n">samples</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">training_generator</span><span class="o">.</span><span class="n">labels</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">training_generator</span><span class="o">.</span><span class="n">metadata</span>

        <span class="c1"># Apply percentage split sampling for metalearner</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="p">,</span> <span class="n">Metalearner_Base</span><span class="p">):</span>
            <span class="n">ps_sampling</span> <span class="o">=</span> <span class="n">sampling_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling</span><span class="p">,</span>
                                         <span class="n">stratified</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                         <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_seed</span><span class="p">)</span>
        <span class="c1"># Pack data according to sampling</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ps_sampling</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">:</span> <span class="n">data_ensemble</span> <span class="o">=</span> <span class="n">ps_sampling</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">data_ensemble</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">ps_sampling</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># Identify path to model directory</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">):</span>
            <span class="n">path_model_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">path_model_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span>

        <span class="c1"># Sequentially iterate over model list</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">)):</span>
            <span class="c1"># Load current model</span>
            <span class="n">path_model</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_model_dir</span><span class="p">,</span>
                                      <span class="s2">&quot;cv_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.model.keras&quot;</span><span class="p">)</span>

            <span class="c1"># Gather NeuralNetwork parameters</span>
            <span class="n">model_paras</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;n_labels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">n_labels</span><span class="p">,</span>
                <span class="s2">&quot;channels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">channels</span><span class="p">,</span>
                <span class="s2">&quot;input_shape&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">input_shape</span><span class="p">,</span>
                <span class="s2">&quot;architecture&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">architecture</span><span class="p">,</span>
                <span class="s2">&quot;pretrained_weights&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">pretrained_weights</span><span class="p">,</span>
                <span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">loss</span><span class="p">,</span>
                <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;activation_output&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">activation_output</span><span class="p">,</span>
                <span class="s2">&quot;fcl_dropout&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fcl_dropout</span><span class="p">,</span>
                <span class="s2">&quot;meta_variables&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">meta_variables</span><span class="p">,</span>
                <span class="s2">&quot;learning_rate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">learning_rate</span><span class="p">,</span>
            <span class="p">}</span>

            <span class="c1"># Gather DataGenerator parameters</span>
            <span class="n">datagen_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;path_imagedir&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">path_imagedir</span><span class="p">,</span>
                             <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span>
                             <span class="s2">&quot;data_aug&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">data_aug</span><span class="p">,</span>
                             <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
                             <span class="s2">&quot;subfunctions&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">subfunctions</span><span class="p">,</span>
                             <span class="s2">&quot;shuffle&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">shuffle</span><span class="p">,</span>
                             <span class="s2">&quot;standardize_mode&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">meta_standardize</span><span class="p">,</span>
                             <span class="s2">&quot;resize&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">meta_input</span><span class="p">,</span>
                             <span class="s2">&quot;grayscale&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">grayscale</span><span class="p">,</span>
                             <span class="s2">&quot;prepare_images&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">prepare_images</span><span class="p">,</span>
                             <span class="s2">&quot;sample_weights&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">sample_weights</span><span class="p">,</span>
                             <span class="s2">&quot;image_format&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">image_format</span><span class="p">,</span>
                             <span class="s2">&quot;loader&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">sample_loader</span><span class="p">,</span>
                             <span class="s2">&quot;workers&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">workers</span><span class="p">,</span>
                             <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">kwargs</span>
            <span class="p">}</span>

            <span class="c1"># Start inference process for model i</span>
            <span class="n">process_queue</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
            <span class="n">process_pred</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">__prediction_process__</span><span class="p">,</span>
                                      <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">process_queue</span><span class="p">,</span>
                                            <span class="n">model_paras</span><span class="p">,</span>
                                            <span class="n">path_model</span><span class="p">,</span>
                                            <span class="n">data_ensemble</span><span class="p">,</span>
                                            <span class="n">datagen_paras</span><span class="p">))</span>
            <span class="n">process_pred</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="n">process_pred</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">preds</span> <span class="o">=</span> <span class="n">process_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

            <span class="c1"># Append preds to ensemble</span>
            <span class="n">preds_ensemble</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>

        <span class="c1"># Preprocess prediction ensemble</span>
        <span class="n">preds_ensemble</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">preds_ensemble</span><span class="p">)</span>
        <span class="n">preds_ensemble</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">preds_ensemble</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">preds_ensemble</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">x_stack</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">preds_ensemble</span><span class="p">,</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="o">*</span><span class="n">c</span><span class="p">))</span>

        <span class="c1"># Start training of stacked metalearner</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="p">,</span> <span class="n">Metalearner_Base</span><span class="p">):</span>
            <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">y_stack</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">data_ensemble</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">x_stack</span><span class="p">,</span> <span class="n">y_stack</span><span class="p">)</span>
            <span class="c1"># Store metalearner model to disk</span>
            <span class="n">path_metalearner</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_model_dir</span><span class="p">,</span>
                                            <span class="s2">&quot;metalearner.model.pickle&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">path_metalearner</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prediction_generator</span><span class="p">,</span> <span class="n">return_ensemble</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Prediction function for Composite.</span>

<span class="sd">        The fitted models and selected Metalearner/Aggregate function will predict classifications</span>
<span class="sd">        for the provided [DataGenerator][aucmedi.data_processing.data_generator.DataGenerator].</span>

<span class="sd">        !!! info</span>
<span class="sd">            More about Metalearners can be found here: [Metelearner][aucmedi.ensemble.metalearner]</span>

<span class="sd">            More about Aggregate functions can be found here: [aggregate][aucmedi.ensemble.aggregate]</span>

<span class="sd">        Args:</span>
<span class="sd">            prediction_generator (DataGenerator):   A data generator which will be used for inference.</span>
<span class="sd">            return_ensemble (bool):                 Option, whether gathered ensemble of predictions should be returned.</span>

<span class="sd">        Returns:</span>
<span class="sd">            preds (numpy.ndarray):                  A NumPy array of predictions formatted with shape (n_samples, n_labels).</span>
<span class="sd">            ensemble (numpy.ndarray):               Optional ensemble of predictions: Will be only passed if `return_ensemble=True`.</span>
<span class="sd">                                                    Shape (n_models, n_samples, n_labels).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Verify if there is a linked cache dictionary</span>
        <span class="n">con_tmp</span> <span class="o">=</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">)</span> <span class="ow">and</span> \
                   <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="n">con_var</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
                   <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">)</span> \
                   <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">con_tmp</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">con_var</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;Composite instance does not have a valid&quot;</span> \
                                    <span class="o">+</span> <span class="s2">&quot;model cache directory!&quot;</span><span class="p">)</span>

        <span class="c1"># Initialize some variables</span>
        <span class="n">temp_dg</span> <span class="o">=</span> <span class="n">prediction_generator</span>
        <span class="n">preds_ensemble</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">preds_final</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Extract data</span>
        <span class="n">data_test</span> <span class="o">=</span> <span class="p">(</span><span class="n">temp_dg</span><span class="o">.</span><span class="n">samples</span><span class="p">,</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>

        <span class="c1"># Identify path to model directory</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">):</span>
            <span class="n">path_model_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">path_model_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span>

        <span class="c1"># Sequentially iterate over model list</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">)):</span>
            <span class="n">path_model</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_model_dir</span><span class="p">,</span>
                                      <span class="s2">&quot;cv_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.model.keras&quot;</span><span class="p">)</span>

            <span class="c1"># Gather NeuralNetwork parameters</span>
            <span class="n">model_paras</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;n_labels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">n_labels</span><span class="p">,</span>
                <span class="s2">&quot;channels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">channels</span><span class="p">,</span>
                <span class="s2">&quot;input_shape&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">input_shape</span><span class="p">,</span>
                <span class="s2">&quot;architecture&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">architecture</span><span class="p">,</span>
                <span class="s2">&quot;pretrained_weights&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">pretrained_weights</span><span class="p">,</span>
                <span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">loss</span><span class="p">,</span>
                <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;activation_output&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">activation_output</span><span class="p">,</span>
                <span class="s2">&quot;fcl_dropout&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fcl_dropout</span><span class="p">,</span>
                <span class="s2">&quot;meta_variables&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">meta_variables</span><span class="p">,</span>
                <span class="s2">&quot;learning_rate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">learning_rate</span><span class="p">,</span>
            <span class="p">}</span>

            <span class="c1"># Gather DataGenerator parameters</span>
            <span class="n">datagen_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;path_imagedir&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">path_imagedir</span><span class="p">,</span>
                             <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span>
                             <span class="s2">&quot;data_aug&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">data_aug</span><span class="p">,</span>
                             <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
                             <span class="s2">&quot;subfunctions&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">subfunctions</span><span class="p">,</span>
                             <span class="s2">&quot;shuffle&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">shuffle</span><span class="p">,</span>
                             <span class="s2">&quot;standardize_mode&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">meta_standardize</span><span class="p">,</span>
                             <span class="s2">&quot;resize&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">meta_input</span><span class="p">,</span>
                             <span class="s2">&quot;grayscale&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">grayscale</span><span class="p">,</span>
                             <span class="s2">&quot;prepare_images&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">prepare_images</span><span class="p">,</span>
                             <span class="s2">&quot;sample_weights&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">sample_weights</span><span class="p">,</span>
                             <span class="s2">&quot;image_format&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">image_format</span><span class="p">,</span>
                             <span class="s2">&quot;loader&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">sample_loader</span><span class="p">,</span>
                             <span class="s2">&quot;workers&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">workers</span><span class="p">,</span>
                             <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">kwargs</span>
            <span class="p">}</span>

            <span class="c1"># Start inference process for model i</span>
            <span class="n">process_queue</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
            <span class="n">process_pred</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">__prediction_process__</span><span class="p">,</span>
                                      <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">process_queue</span><span class="p">,</span>
                                            <span class="n">model_paras</span><span class="p">,</span>
                                            <span class="n">path_model</span><span class="p">,</span>
                                            <span class="n">data_test</span><span class="p">,</span>
                                            <span class="n">datagen_paras</span><span class="p">))</span>
            <span class="n">process_pred</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="n">process_pred</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
            <span class="n">preds</span> <span class="o">=</span> <span class="n">process_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

            <span class="c1"># Append preds to ensemble</span>
            <span class="n">preds_ensemble</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>

        <span class="c1"># Preprocess prediction ensemble</span>
        <span class="n">preds_ensemble</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">preds_ensemble</span><span class="p">)</span>
        <span class="n">preds_ensemble</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">preds_ensemble</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Apply heterogenous metalearner</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="p">,</span> <span class="n">Metalearner_Base</span><span class="p">):</span>
            <span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">preds_ensemble</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">x_stack</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">preds_ensemble</span><span class="p">,</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="o">*</span><span class="n">c</span><span class="p">))</span>
            <span class="n">preds_final</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">x_stack</span><span class="p">)</span>
        <span class="c1"># Apply homogeneous aggregate function</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="p">,</span> <span class="n">Aggregate_Base</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">preds_ensemble</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">pred_sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">preds_ensemble</span><span class="p">[</span><span class="n">i</span><span class="p">,:,:])</span>
                <span class="n">preds_final</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred_sample</span><span class="p">)</span>

        <span class="c1"># Convert prediction list to NumPy</span>
        <span class="n">preds_final</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">preds_final</span><span class="p">)</span>

        <span class="c1"># Return ensembled predictions</span>
        <span class="k">if</span> <span class="n">return_ensemble</span> <span class="p">:</span> <span class="k">return</span> <span class="n">preds_final</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">preds_ensemble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> <span class="k">return</span> <span class="n">preds_final</span>

    <span class="c1"># Dump model to file</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Store temporary Composite models directory permanently to disk at desired location.</span>

<span class="sd">        If the model directory is a provided path which is already persistent on the disk,</span>
<span class="sd">        the directory is copied in order to keep original data persistent.</span>

<span class="sd">        Args:</span>
<span class="sd">            directory_path (str):       Path to store the model directory on disk.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;Composite does not have a valid model cache directory!&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">):</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">copytree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">directory_path</span><span class="p">,</span>
                            <span class="n">dirs_exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="o">=</span> <span class="n">directory_path</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">copytree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">directory_path</span><span class="p">,</span> <span class="n">dirs_exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="o">=</span> <span class="n">directory_path</span>

    <span class="c1"># Load model from file</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Load a Composite model directory which can be used for Metalearner based inference.</span>

<span class="sd">        Args:</span>
<span class="sd">            directory_path (str):       Input path, from which the Composite models will be loaded.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check directory existence</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">directory_path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;Provided model directory path does not exist!&quot;</span><span class="p">,</span>
                                    <span class="n">directory_path</span><span class="p">)</span>
        <span class="c1"># Check model existence</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">)):</span>
            <span class="n">path_model</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory_path</span><span class="p">,</span>
                                      <span class="s2">&quot;cv_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.model.keras&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path_model</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;Composite model &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> \
                                        <span class="s2">&quot; does not exist!&quot;</span><span class="p">,</span> <span class="n">path_model</span><span class="p">)</span>
        <span class="c1"># If heterogenous metalearner -&gt; load metalearner model file</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="p">,</span> <span class="n">Metalearner_Base</span><span class="p">):</span>
            <span class="n">path_model</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory_path</span><span class="p">,</span>
                                      <span class="s2">&quot;metalearner.model.pickle&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path_model</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;Metalearner model does not exist!&quot;</span><span class="p">,</span>
                                        <span class="n">path_model</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path_model</span><span class="p">)</span>

        <span class="c1"># Update model directory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="o">=</span> <span class="n">directory_path</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="aucmedi.ensemble.composite.Composite.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">model_list</span><span class="p">,</span> <span class="n">metalearner</span><span class="o">=</span><span class="s1">&#39;logistic_regression&#39;</span><span class="p">,</span> <span class="n">k_fold</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="p">[</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">],</span> <span class="n">fixed_datagenerator</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#aucmedi.ensemble.composite.Composite.__init__" class="headerlink" title="Permanent link">¤</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initialization function for creating a Composite object.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model_list</code></td>
          <td>
                <code>list of NeuralNetwork</code>
          </td>
          <td><p>List of instances of AUCMEDI neural network class.
                                        The number of models (<code>len(model_list)</code>) have to be equal to <code>k_fold</code>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>metalearner</code></td>
          <td>
                <code>str, Metalearner or Aggregate</code>
          </td>
          <td><p>Metalearner class instance / a string for an AUCMEDI Metalearner,
                                        or Aggregate function / a string for an AUCMEDI Aggregate function.</p></td>
          <td>
                <code>&#39;logistic_regression&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>k_fold</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of folds (k) for the Cross-Validation. Must be at least 2.</p></td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr>
          <td><code>sampling</code></td>
          <td>
                <code>list of float</code>
          </td>
          <td><p>List of percentage values with split sizes. Should be 2x percentage values
                                        for heterogenous metalearner (must sum up to 1.0).</p></td>
          <td>
                <code>[0.85, 0.15]</code>
          </td>
        </tr>
        <tr>
          <td><code>fixed_datagenerator</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Boolean, whether using fixed parameters of passed DataGenerator or
                                        using default architecture paramters for Resizing and Standardize.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>aucmedi/ensemble/composite.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_list</span><span class="p">,</span> <span class="n">metalearner</span><span class="o">=</span><span class="s2">&quot;logistic_regression&quot;</span><span class="p">,</span>
             <span class="n">k_fold</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="p">[</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">],</span> <span class="n">fixed_datagenerator</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Initialization function for creating a Composite object.</span>

<span class="sd">    Args:</span>
<span class="sd">        model_list (list of NeuralNetwork):         List of instances of AUCMEDI neural network class.</span>
<span class="sd">                                                    The number of models (`len(model_list)`) have to be equal to `k_fold`.</span>
<span class="sd">        metalearner (str, Metalearner or Aggregate):Metalearner class instance / a string for an AUCMEDI Metalearner,</span>
<span class="sd">                                                    or Aggregate function / a string for an AUCMEDI Aggregate function.</span>
<span class="sd">        k_fold (int):                               Number of folds (k) for the Cross-Validation. Must be at least 2.</span>
<span class="sd">        sampling (list of float):                   List of percentage values with split sizes. Should be 2x percentage values</span>
<span class="sd">                                                    for heterogenous metalearner (must sum up to 1.0).</span>
<span class="sd">        fixed_datagenerator (bool):                 Boolean, whether using fixed parameters of passed DataGenerator or</span>
<span class="sd">                                                    using default architecture paramters for Resizing and Standardize.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Cache class variables</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span> <span class="o">=</span> <span class="n">model_list</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">metalearner</span> <span class="o">=</span> <span class="n">metalearner</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sampling</span> <span class="o">=</span> <span class="n">sampling</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">k_fold</span> <span class="o">=</span> <span class="n">k_fold</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fixed_datagenerator</span> <span class="o">=</span> <span class="n">fixed_datagenerator</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sampling_seed</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Initialize Metalearner</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metalearner</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">metalearner</span> <span class="ow">in</span> <span class="n">metalearner_dict</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span> <span class="o">=</span> <span class="n">metalearner_dict</span><span class="p">[</span><span class="n">metalearner</span><span class="p">]()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metalearner</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">metalearner</span> <span class="ow">in</span> <span class="n">aggregate_dict</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span> <span class="o">=</span> <span class="n">aggregate_dict</span><span class="p">[</span><span class="n">metalearner</span><span class="p">]()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metalearner</span><span class="p">,</span> <span class="n">Metalearner_Base</span><span class="p">)</span> <span class="ow">or</span> \
         <span class="nb">isinstance</span><span class="p">(</span><span class="n">metalearner</span><span class="p">,</span> <span class="n">Aggregate_Base</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span> <span class="o">=</span> <span class="n">metalearner</span>
    <span class="k">else</span> <span class="p">:</span> <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unknown type of Metalearner (neither known &quot;</span> <span class="o">+</span> \
                           <span class="s2">&quot;ensembler nor Aggregate or Metalearner class)!&quot;</span><span class="p">)</span>

    <span class="c1"># Verify model list length</span>
    <span class="k">if</span> <span class="n">k_fold</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Length of model_list and k_fold has to be equal!&quot;</span><span class="p">)</span>

    <span class="c1"># Set multiprocessing method to spawn</span>
    <span class="n">mp</span><span class="o">.</span><span class="n">set_start_method</span><span class="p">(</span><span class="s2">&quot;spawn&quot;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="aucmedi.ensemble.composite.Composite.dump" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dump</span><span class="p">(</span><span class="n">directory_path</span><span class="p">)</span></code>

<a href="#aucmedi.ensemble.composite.Composite.dump" class="headerlink" title="Permanent link">¤</a></h3>


  <div class="doc doc-contents ">
  
      <p>Store temporary Composite models directory permanently to disk at desired location.</p>
<p>If the model directory is a provided path which is already persistent on the disk,
the directory is copied in order to keep original data persistent.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>directory_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Path to store the model directory on disk.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>aucmedi/ensemble/composite.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Store temporary Composite models directory permanently to disk at desired location.</span>

<span class="sd">    If the model directory is a provided path which is already persistent on the disk,</span>
<span class="sd">    the directory is copied in order to keep original data persistent.</span>

<span class="sd">    Args:</span>
<span class="sd">        directory_path (str):       Path to store the model directory on disk.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;Composite does not have a valid model cache directory!&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">):</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copytree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">directory_path</span><span class="p">,</span>
                        <span class="n">dirs_exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="o">=</span> <span class="n">directory_path</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copytree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">directory_path</span><span class="p">,</span> <span class="n">dirs_exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="o">=</span> <span class="n">directory_path</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="aucmedi.ensemble.composite.Composite.load" class="doc doc-heading">
<code class="highlight language-python"><span class="n">load</span><span class="p">(</span><span class="n">directory_path</span><span class="p">)</span></code>

<a href="#aucmedi.ensemble.composite.Composite.load" class="headerlink" title="Permanent link">¤</a></h3>


  <div class="doc doc-contents ">
  
      <p>Load a Composite model directory which can be used for Metalearner based inference.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>directory_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Input path, from which the Composite models will be loaded.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>aucmedi/ensemble/composite.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Load a Composite model directory which can be used for Metalearner based inference.</span>

<span class="sd">    Args:</span>
<span class="sd">        directory_path (str):       Input path, from which the Composite models will be loaded.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check directory existence</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">directory_path</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;Provided model directory path does not exist!&quot;</span><span class="p">,</span>
                                <span class="n">directory_path</span><span class="p">)</span>
    <span class="c1"># Check model existence</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">)):</span>
        <span class="n">path_model</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory_path</span><span class="p">,</span>
                                  <span class="s2">&quot;cv_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.model.keras&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path_model</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;Composite model &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> \
                                    <span class="s2">&quot; does not exist!&quot;</span><span class="p">,</span> <span class="n">path_model</span><span class="p">)</span>
    <span class="c1"># If heterogenous metalearner -&gt; load metalearner model file</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="p">,</span> <span class="n">Metalearner_Base</span><span class="p">):</span>
        <span class="n">path_model</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory_path</span><span class="p">,</span>
                                  <span class="s2">&quot;metalearner.model.pickle&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path_model</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;Metalearner model does not exist!&quot;</span><span class="p">,</span>
                                    <span class="n">path_model</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path_model</span><span class="p">)</span>

    <span class="c1"># Update model directory</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="o">=</span> <span class="n">directory_path</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="aucmedi.ensemble.composite.Composite.predict" class="doc doc-heading">
<code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">prediction_generator</span><span class="p">,</span> <span class="n">return_ensemble</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#aucmedi.ensemble.composite.Composite.predict" class="headerlink" title="Permanent link">¤</a></h3>


  <div class="doc doc-contents ">
  
      <p>Prediction function for Composite.</p>
<p>The fitted models and selected Metalearner/Aggregate function will predict classifications
for the provided <a class="autorefs autorefs-internal" href="../../data_processing/data_generator/#aucmedi.data_processing.data_generator.DataGenerator">DataGenerator</a>.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>More about Metalearners can be found here: <a class="autorefs autorefs-internal" href="../metalearner/#aucmedi.ensemble.metalearner">Metelearner</a></p>
<p>More about Aggregate functions can be found here: <a class="autorefs autorefs-internal" href="../aggregate/#aucmedi.ensemble.aggregate">aggregate</a></p>
</div>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>prediction_generator</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="aucmedi.DataGenerator" href="../../data_processing/data_generator/#aucmedi.data_processing.data_generator.DataGenerator">DataGenerator</a></code>
          </td>
          <td><p>A data generator which will be used for inference.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>return_ensemble</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Option, whether gathered ensemble of predictions should be returned.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>preds</code></td>          <td>
                <code>numpy.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>A NumPy array of predictions formatted with shape (n_samples, n_labels).</p></td>
        </tr>
        <tr>
<td><code>ensemble</code></td>          <td>
                <code>numpy.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>Optional ensemble of predictions: Will be only passed if <code>return_ensemble=True</code>.
                                    Shape (n_models, n_samples, n_labels).</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>aucmedi/ensemble/composite.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prediction_generator</span><span class="p">,</span> <span class="n">return_ensemble</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Prediction function for Composite.</span>

<span class="sd">    The fitted models and selected Metalearner/Aggregate function will predict classifications</span>
<span class="sd">    for the provided [DataGenerator][aucmedi.data_processing.data_generator.DataGenerator].</span>

<span class="sd">    !!! info</span>
<span class="sd">        More about Metalearners can be found here: [Metelearner][aucmedi.ensemble.metalearner]</span>

<span class="sd">        More about Aggregate functions can be found here: [aggregate][aucmedi.ensemble.aggregate]</span>

<span class="sd">    Args:</span>
<span class="sd">        prediction_generator (DataGenerator):   A data generator which will be used for inference.</span>
<span class="sd">        return_ensemble (bool):                 Option, whether gathered ensemble of predictions should be returned.</span>

<span class="sd">    Returns:</span>
<span class="sd">        preds (numpy.ndarray):                  A NumPy array of predictions formatted with shape (n_samples, n_labels).</span>
<span class="sd">        ensemble (numpy.ndarray):               Optional ensemble of predictions: Will be only passed if `return_ensemble=True`.</span>
<span class="sd">                                                Shape (n_models, n_samples, n_labels).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Verify if there is a linked cache dictionary</span>
    <span class="n">con_tmp</span> <span class="o">=</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">)</span> <span class="ow">and</span> \
               <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="n">con_var</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> \
               <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">)</span> \
               <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">con_tmp</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">con_var</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;Composite instance does not have a valid&quot;</span> \
                                <span class="o">+</span> <span class="s2">&quot;model cache directory!&quot;</span><span class="p">)</span>

    <span class="c1"># Initialize some variables</span>
    <span class="n">temp_dg</span> <span class="o">=</span> <span class="n">prediction_generator</span>
    <span class="n">preds_ensemble</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">preds_final</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Extract data</span>
    <span class="n">data_test</span> <span class="o">=</span> <span class="p">(</span><span class="n">temp_dg</span><span class="o">.</span><span class="n">samples</span><span class="p">,</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>

    <span class="c1"># Identify path to model directory</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">):</span>
        <span class="n">path_model_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">name</span>
    <span class="k">else</span> <span class="p">:</span> <span class="n">path_model_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span>

    <span class="c1"># Sequentially iterate over model list</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">)):</span>
        <span class="n">path_model</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_model_dir</span><span class="p">,</span>
                                  <span class="s2">&quot;cv_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.model.keras&quot;</span><span class="p">)</span>

        <span class="c1"># Gather NeuralNetwork parameters</span>
        <span class="n">model_paras</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;n_labels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">n_labels</span><span class="p">,</span>
            <span class="s2">&quot;channels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">channels</span><span class="p">,</span>
            <span class="s2">&quot;input_shape&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">input_shape</span><span class="p">,</span>
            <span class="s2">&quot;architecture&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">architecture</span><span class="p">,</span>
            <span class="s2">&quot;pretrained_weights&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">pretrained_weights</span><span class="p">,</span>
            <span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">loss</span><span class="p">,</span>
            <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;activation_output&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">activation_output</span><span class="p">,</span>
            <span class="s2">&quot;fcl_dropout&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fcl_dropout</span><span class="p">,</span>
            <span class="s2">&quot;meta_variables&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">meta_variables</span><span class="p">,</span>
            <span class="s2">&quot;learning_rate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">learning_rate</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="c1"># Gather DataGenerator parameters</span>
        <span class="n">datagen_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;path_imagedir&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">path_imagedir</span><span class="p">,</span>
                         <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span>
                         <span class="s2">&quot;data_aug&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">data_aug</span><span class="p">,</span>
                         <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
                         <span class="s2">&quot;subfunctions&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">subfunctions</span><span class="p">,</span>
                         <span class="s2">&quot;shuffle&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">shuffle</span><span class="p">,</span>
                         <span class="s2">&quot;standardize_mode&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">meta_standardize</span><span class="p">,</span>
                         <span class="s2">&quot;resize&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">meta_input</span><span class="p">,</span>
                         <span class="s2">&quot;grayscale&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">grayscale</span><span class="p">,</span>
                         <span class="s2">&quot;prepare_images&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">prepare_images</span><span class="p">,</span>
                         <span class="s2">&quot;sample_weights&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">sample_weights</span><span class="p">,</span>
                         <span class="s2">&quot;image_format&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">image_format</span><span class="p">,</span>
                         <span class="s2">&quot;loader&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">sample_loader</span><span class="p">,</span>
                         <span class="s2">&quot;workers&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">workers</span><span class="p">,</span>
                         <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">kwargs</span>
        <span class="p">}</span>

        <span class="c1"># Start inference process for model i</span>
        <span class="n">process_queue</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
        <span class="n">process_pred</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">__prediction_process__</span><span class="p">,</span>
                                  <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">process_queue</span><span class="p">,</span>
                                        <span class="n">model_paras</span><span class="p">,</span>
                                        <span class="n">path_model</span><span class="p">,</span>
                                        <span class="n">data_test</span><span class="p">,</span>
                                        <span class="n">datagen_paras</span><span class="p">))</span>
        <span class="n">process_pred</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="n">process_pred</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="n">preds</span> <span class="o">=</span> <span class="n">process_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

        <span class="c1"># Append preds to ensemble</span>
        <span class="n">preds_ensemble</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>

    <span class="c1"># Preprocess prediction ensemble</span>
    <span class="n">preds_ensemble</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">preds_ensemble</span><span class="p">)</span>
    <span class="n">preds_ensemble</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">preds_ensemble</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Apply heterogenous metalearner</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="p">,</span> <span class="n">Metalearner_Base</span><span class="p">):</span>
        <span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">preds_ensemble</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">x_stack</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">preds_ensemble</span><span class="p">,</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="o">*</span><span class="n">c</span><span class="p">))</span>
        <span class="n">preds_final</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">x_stack</span><span class="p">)</span>
    <span class="c1"># Apply homogeneous aggregate function</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="p">,</span> <span class="n">Aggregate_Base</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">preds_ensemble</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">pred_sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">preds_ensemble</span><span class="p">[</span><span class="n">i</span><span class="p">,:,:])</span>
            <span class="n">preds_final</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred_sample</span><span class="p">)</span>

    <span class="c1"># Convert prediction list to NumPy</span>
    <span class="n">preds_final</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">preds_final</span><span class="p">)</span>

    <span class="c1"># Return ensembled predictions</span>
    <span class="k">if</span> <span class="n">return_ensemble</span> <span class="p">:</span> <span class="k">return</span> <span class="n">preds_final</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">preds_ensemble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span> <span class="p">:</span> <span class="k">return</span> <span class="n">preds_final</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="aucmedi.ensemble.composite.Composite.train" class="doc doc-heading">
<code class="highlight language-python"><span class="n">train</span><span class="p">(</span><span class="n">training_generator</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[],</span> <span class="n">class_weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transfer_learning</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">metalearner_fitting</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#aucmedi.ensemble.composite.Composite.train" class="headerlink" title="Permanent link">¤</a></h3>


  <div class="doc doc-contents ">
  
      <p>Training function for fitting the provided NeuralNetwork models.</p>
<p>The training data will be sampled according to a percentage split in which
<a class="autorefs autorefs-internal" title="DataGenerator" href="../../data_processing/data_generator/#aucmedi.data_processing.data_generator.DataGenerator">DataGenerators</a> for model training
and metalearner training if a metalearner is provided. Else all data is used as model
training subset. The model training subset is furthermore sampled via cross-validation.</p>
<p>It is also possible to pass custom Callback classes in order to obtain more information.</p>
<p>For more information on the fitting process, check out <a class="autorefs autorefs-internal" title="train(training_generator, validation_generator=None, epochs=20, iterations=None, callbacks=[], class_weights=None, transfer_learning=False)" href="../../neural_network/model/#aucmedi.neural_network.model.NeuralNetwork.train">NeuralNetwork.train()</a>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>training_generator</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="aucmedi.DataGenerator" href="../../data_processing/data_generator/#aucmedi.data_processing.data_generator.DataGenerator">DataGenerator</a></code>
          </td>
          <td><p>A data generator which will be used for training (will be split according
                                    to percentage split and k-fold cross-validation sampling).</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>epochs</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of epochs. A single epoch is defined as one iteration through
                                    the complete data set.</p></td>
          <td>
                <code>20</code>
          </td>
        </tr>
        <tr>
          <td><code>iterations</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of iterations (batches) in a single epoch.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>callbacks</code></td>
          <td>
                <code>list of Callback classes</code>
          </td>
          <td><p>A list of Callback classes for custom evaluation.</p></td>
          <td>
                <code>[]</code>
          </td>
        </tr>
        <tr>
          <td><code>class_weights</code></td>
          <td>
                <code>dictionary or list</code>
          </td>
          <td><p>A list or dictionary of float values to handle class unbalance.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>transfer_learning</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Option whether a transfer learning training should be performed.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>metalearner_fitting</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Option whether the Metalearner fitting process should be included in the
                                    Composite training process. The <code>train_metalearner()</code> function can also be
                                    run manually (or repeatedly).</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>history</code></td>          <td>
                <code>dict</code>
          </td>
          <td><p>A history dictionary from a Keras history object which contains several logs.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>aucmedi/ensemble/composite.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">training_generator</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">callbacks</span><span class="o">=</span><span class="p">[],</span> <span class="n">class_weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transfer_learning</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">metalearner_fitting</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Training function for fitting the provided NeuralNetwork models.</span>

<span class="sd">    The training data will be sampled according to a percentage split in which</span>
<span class="sd">    [DataGenerators][aucmedi.data_processing.data_generator.DataGenerator] for model training</span>
<span class="sd">    and metalearner training if a metalearner is provided. Else all data is used as model</span>
<span class="sd">    training subset. The model training subset is furthermore sampled via cross-validation.</span>

<span class="sd">    It is also possible to pass custom Callback classes in order to obtain more information.</span>

<span class="sd">    For more information on the fitting process, check out [NeuralNetwork.train()][aucmedi.neural_network.model.NeuralNetwork.train].</span>

<span class="sd">    Args:</span>
<span class="sd">        training_generator (DataGenerator):     A data generator which will be used for training (will be split according</span>
<span class="sd">                                                to percentage split and k-fold cross-validation sampling).</span>
<span class="sd">        epochs (int):                           Number of epochs. A single epoch is defined as one iteration through</span>
<span class="sd">                                                the complete data set.</span>
<span class="sd">        iterations (int):                       Number of iterations (batches) in a single epoch.</span>
<span class="sd">        callbacks (list of Callback classes):   A list of Callback classes for custom evaluation.</span>
<span class="sd">        class_weights (dictionary or list):     A list or dictionary of float values to handle class unbalance.</span>
<span class="sd">        transfer_learning (bool):               Option whether a transfer learning training should be performed.</span>
<span class="sd">        metalearner_fitting (bool):             Option whether the Metalearner fitting process should be included in the</span>
<span class="sd">                                                Composite training process. The `train_metalearner()` function can also be</span>
<span class="sd">                                                run manually (or repeatedly).</span>
<span class="sd">    Returns:</span>
<span class="sd">        history (dict):                         A history dictionary from a Keras history object which contains several logs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">temp_dg</span> <span class="o">=</span> <span class="n">training_generator</span>    <span class="c1"># Template DataGenerator variable for faster access</span>
    <span class="n">history_composite</span> <span class="o">=</span> <span class="p">{}</span>           <span class="c1"># Final history dictionary</span>

    <span class="c1"># Create temporary model directory</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;aucmedi.tmp.&quot;</span><span class="p">,</span>
                                                 <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;.composite&quot;</span><span class="p">)</span>

    <span class="c1"># Obtain training data</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">training_generator</span><span class="o">.</span><span class="n">samples</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">training_generator</span><span class="o">.</span><span class="n">labels</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">training_generator</span><span class="o">.</span><span class="n">metadata</span>

    <span class="c1"># Apply percentage split sampling for metalearner</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="p">,</span> <span class="n">Metalearner_Base</span><span class="p">):</span>
        <span class="n">ps_sampling</span> <span class="o">=</span> <span class="n">sampling_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling</span><span class="p">,</span>
                                     <span class="n">stratified</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_seed</span><span class="p">)</span>
        <span class="c1"># Pack data according to sampling</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ps_sampling</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">ps_sampling</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ps_sampling</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Apply cross-validaton sampling</span>
    <span class="n">cv_sampling</span> <span class="o">=</span> <span class="n">sampling_kfold</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n_splits</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">k_fold</span><span class="p">,</span>
                                 <span class="n">stratified</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Sequentially iterate over model list</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">)):</span>
        <span class="c1"># Pack data into a tuple</span>
        <span class="n">fold</span> <span class="o">=</span> <span class="n">cv_sampling</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fold</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">test_x</span><span class="p">,</span> <span class="n">test_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">fold</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">test_x</span><span class="p">,</span> <span class="n">test_y</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">data</span> <span class="o">=</span> <span class="n">fold</span>

        <span class="c1"># Create model specific callback list</span>
        <span class="n">callbacks_model</span> <span class="o">=</span> <span class="n">callbacks</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c1"># Extend Callback list</span>
        <span class="n">path_model</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                  <span class="s2">&quot;cv_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.model.keras&quot;</span><span class="p">)</span>
        <span class="n">cb_mc</span> <span class="o">=</span> <span class="n">ModelCheckpoint</span><span class="p">(</span><span class="n">path_model</span><span class="p">,</span>
                                <span class="n">monitor</span><span class="o">=</span><span class="s2">&quot;val_loss&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                <span class="n">save_best_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;min&quot;</span><span class="p">)</span>
        <span class="n">cb_cl</span> <span class="o">=</span> <span class="n">CSVLogger</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                             <span class="s2">&quot;cv_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> \
                                             <span class="s2">&quot;.logs.csv&quot;</span><span class="p">),</span>
                          <span class="n">separator</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">callbacks_model</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">cb_mc</span><span class="p">,</span> <span class="n">cb_cl</span><span class="p">])</span>

        <span class="c1"># Gather NeuralNetwork parameters</span>
        <span class="n">model_paras</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;n_labels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">n_labels</span><span class="p">,</span>
            <span class="s2">&quot;channels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">channels</span><span class="p">,</span>
            <span class="s2">&quot;input_shape&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">input_shape</span><span class="p">,</span>
            <span class="s2">&quot;architecture&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">architecture</span><span class="p">,</span>
            <span class="s2">&quot;pretrained_weights&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">pretrained_weights</span><span class="p">,</span>
            <span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">loss</span><span class="p">,</span>
            <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;activation_output&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">activation_output</span><span class="p">,</span>
            <span class="s2">&quot;fcl_dropout&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fcl_dropout</span><span class="p">,</span>
            <span class="s2">&quot;meta_variables&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">meta_variables</span><span class="p">,</span>
            <span class="s2">&quot;learning_rate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">learning_rate</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="c1"># Gather DataGenerator parameters</span>
        <span class="n">datagen_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;path_imagedir&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">path_imagedir</span><span class="p">,</span>
                         <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span>
                         <span class="s2">&quot;data_aug&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">data_aug</span><span class="p">,</span>
                         <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
                         <span class="s2">&quot;subfunctions&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">subfunctions</span><span class="p">,</span>
                         <span class="s2">&quot;shuffle&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">shuffle</span><span class="p">,</span>
                         <span class="s2">&quot;standardize_mode&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">meta_standardize</span><span class="p">,</span>
                         <span class="s2">&quot;resize&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">meta_input</span><span class="p">,</span>
                         <span class="s2">&quot;grayscale&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">grayscale</span><span class="p">,</span>
                         <span class="s2">&quot;prepare_images&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">prepare_images</span><span class="p">,</span>
                         <span class="s2">&quot;sample_weights&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">sample_weights</span><span class="p">,</span>
                         <span class="s2">&quot;image_format&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">image_format</span><span class="p">,</span>
                         <span class="s2">&quot;loader&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">sample_loader</span><span class="p">,</span>
                         <span class="s2">&quot;workers&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">workers</span><span class="p">,</span>
                         <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">kwargs</span>
        <span class="p">}</span>

        <span class="c1"># Gather training parameters</span>
        <span class="n">parameters_training</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;epochs&quot;</span><span class="p">:</span> <span class="n">epochs</span><span class="p">,</span>
                            <span class="s2">&quot;iterations&quot;</span><span class="p">:</span> <span class="n">iterations</span><span class="p">,</span>
                            <span class="s2">&quot;callbacks&quot;</span><span class="p">:</span> <span class="n">callbacks_model</span><span class="p">,</span>
                            <span class="s2">&quot;class_weights&quot;</span><span class="p">:</span> <span class="n">class_weights</span><span class="p">,</span>
                            <span class="s2">&quot;transfer_learning&quot;</span><span class="p">:</span> <span class="n">transfer_learning</span>
        <span class="p">}</span>

        <span class="c1"># Start training process</span>
        <span class="n">process_queue</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
        <span class="n">process_train</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">__training_process__</span><span class="p">,</span>
                                   <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">process_queue</span><span class="p">,</span>
                                         <span class="n">data</span><span class="p">,</span>
                                         <span class="n">model_paras</span><span class="p">,</span>
                                         <span class="n">datagen_paras</span><span class="p">,</span>
                                         <span class="n">parameters_training</span><span class="p">))</span>
        <span class="n">process_train</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="n">process_train</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="n">cv_history</span> <span class="o">=</span> <span class="n">process_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="c1"># Combine logged history objects</span>
        <span class="n">hnn</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cv_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">cv_history</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="n">history_composite</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">history_composite</span><span class="p">,</span> <span class="o">**</span><span class="n">hnn</span><span class="p">}</span>

    <span class="c1"># Perform metalearner model training</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="p">,</span> <span class="n">Metalearner_Base</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_metalearner</span><span class="p">(</span><span class="n">temp_dg</span><span class="p">)</span>

    <span class="c1"># Return Composite history object</span>
    <span class="k">return</span> <span class="n">history_composite</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="aucmedi.ensemble.composite.Composite.train_metalearner" class="doc doc-heading">
<code class="highlight language-python"><span class="n">train_metalearner</span><span class="p">(</span><span class="n">training_generator</span><span class="p">)</span></code>

<a href="#aucmedi.ensemble.composite.Composite.train_metalearner" class="headerlink" title="Permanent link">¤</a></h3>


  <div class="doc doc-contents ">
  
      <p>Training function for fitting the Metalearner model.</p>
<p>Function will be called automatically in the <code>train()</code> function if
the parameter <code>metalearner_fitting</code> is true.</p>
<p>However, this function can also be called multiple times for training
different Metalearner types without the need of time-extensive
re-training of the <a class="autorefs autorefs-internal" href="../../neural_network/model/#aucmedi.neural_network.model">NeuralNetwork</a> models.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>training_generator</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="aucmedi.DataGenerator" href="../../data_processing/data_generator/#aucmedi.data_processing.data_generator.DataGenerator">DataGenerator</a></code>
          </td>
          <td><p>A data generator which will be used for training (will be split according
                                    to percentage split).</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>aucmedi/ensemble/composite.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">train_metalearner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">training_generator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Training function for fitting the Metalearner model.</span>

<span class="sd">    Function will be called automatically in the `train()` function if</span>
<span class="sd">    the parameter `metalearner_fitting` is true.</span>

<span class="sd">    However, this function can also be called multiple times for training</span>
<span class="sd">    different Metalearner types without the need of time-extensive</span>
<span class="sd">    re-training of the [NeuralNetwork][aucmedi.neural_network.model] models.</span>

<span class="sd">    Args:</span>
<span class="sd">        training_generator (DataGenerator):     A data generator which will be used for training (will be split according</span>
<span class="sd">                                                to percentage split).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Skipping metalearner training if aggregate function</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="p">,</span> <span class="n">Aggregate_Base</span><span class="p">)</span> <span class="p">:</span> <span class="k">return</span>

    <span class="n">temp_dg</span> <span class="o">=</span> <span class="n">training_generator</span>    <span class="c1"># Template DataGenerator variable for faster access</span>
    <span class="n">preds_ensemble</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Obtain training data</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">training_generator</span><span class="o">.</span><span class="n">samples</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">training_generator</span><span class="o">.</span><span class="n">labels</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">training_generator</span><span class="o">.</span><span class="n">metadata</span>

    <span class="c1"># Apply percentage split sampling for metalearner</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="p">,</span> <span class="n">Metalearner_Base</span><span class="p">):</span>
        <span class="n">ps_sampling</span> <span class="o">=</span> <span class="n">sampling_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling</span><span class="p">,</span>
                                     <span class="n">stratified</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">iterative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_seed</span><span class="p">)</span>
    <span class="c1"># Pack data according to sampling</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ps_sampling</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">:</span> <span class="n">data_ensemble</span> <span class="o">=</span> <span class="n">ps_sampling</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span> <span class="p">:</span> <span class="n">data_ensemble</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">ps_sampling</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="kc">None</span><span class="p">)</span>

    <span class="c1"># Identify path to model directory</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">,</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">):</span>
        <span class="n">path_model_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">name</span>
    <span class="k">else</span> <span class="p">:</span> <span class="n">path_model_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span>

    <span class="c1"># Sequentially iterate over model list</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">)):</span>
        <span class="c1"># Load current model</span>
        <span class="n">path_model</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_model_dir</span><span class="p">,</span>
                                  <span class="s2">&quot;cv_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.model.keras&quot;</span><span class="p">)</span>

        <span class="c1"># Gather NeuralNetwork parameters</span>
        <span class="n">model_paras</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;n_labels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">n_labels</span><span class="p">,</span>
            <span class="s2">&quot;channels&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">channels</span><span class="p">,</span>
            <span class="s2">&quot;input_shape&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">input_shape</span><span class="p">,</span>
            <span class="s2">&quot;architecture&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">architecture</span><span class="p">,</span>
            <span class="s2">&quot;pretrained_weights&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">pretrained_weights</span><span class="p">,</span>
            <span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">loss</span><span class="p">,</span>
            <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;activation_output&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">activation_output</span><span class="p">,</span>
            <span class="s2">&quot;fcl_dropout&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">fcl_dropout</span><span class="p">,</span>
            <span class="s2">&quot;meta_variables&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">meta_variables</span><span class="p">,</span>
            <span class="s2">&quot;learning_rate&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">learning_rate</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="c1"># Gather DataGenerator parameters</span>
        <span class="n">datagen_paras</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;path_imagedir&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">path_imagedir</span><span class="p">,</span>
                         <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span>
                         <span class="s2">&quot;data_aug&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">data_aug</span><span class="p">,</span>
                         <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">seed</span><span class="p">,</span>
                         <span class="s2">&quot;subfunctions&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">subfunctions</span><span class="p">,</span>
                         <span class="s2">&quot;shuffle&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">shuffle</span><span class="p">,</span>
                         <span class="s2">&quot;standardize_mode&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">meta_standardize</span><span class="p">,</span>
                         <span class="s2">&quot;resize&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">meta_input</span><span class="p">,</span>
                         <span class="s2">&quot;grayscale&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">grayscale</span><span class="p">,</span>
                         <span class="s2">&quot;prepare_images&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">prepare_images</span><span class="p">,</span>
                         <span class="s2">&quot;sample_weights&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">sample_weights</span><span class="p">,</span>
                         <span class="s2">&quot;image_format&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">image_format</span><span class="p">,</span>
                         <span class="s2">&quot;loader&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">sample_loader</span><span class="p">,</span>
                         <span class="s2">&quot;workers&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">workers</span><span class="p">,</span>
                         <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="n">temp_dg</span><span class="o">.</span><span class="n">kwargs</span>
        <span class="p">}</span>

        <span class="c1"># Start inference process for model i</span>
        <span class="n">process_queue</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
        <span class="n">process_pred</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">__prediction_process__</span><span class="p">,</span>
                                  <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">process_queue</span><span class="p">,</span>
                                        <span class="n">model_paras</span><span class="p">,</span>
                                        <span class="n">path_model</span><span class="p">,</span>
                                        <span class="n">data_ensemble</span><span class="p">,</span>
                                        <span class="n">datagen_paras</span><span class="p">))</span>
        <span class="n">process_pred</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="n">process_pred</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="n">preds</span> <span class="o">=</span> <span class="n">process_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

        <span class="c1"># Append preds to ensemble</span>
        <span class="n">preds_ensemble</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>

    <span class="c1"># Preprocess prediction ensemble</span>
    <span class="n">preds_ensemble</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">preds_ensemble</span><span class="p">)</span>
    <span class="n">preds_ensemble</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">preds_ensemble</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">preds_ensemble</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">x_stack</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">preds_ensemble</span><span class="p">,</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">m</span><span class="o">*</span><span class="n">c</span><span class="p">))</span>

    <span class="c1"># Start training of stacked metalearner</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="p">,</span> <span class="n">Metalearner_Base</span><span class="p">):</span>
        <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">y_stack</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="o">=</span> <span class="n">data_ensemble</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">x_stack</span><span class="p">,</span> <span class="n">y_stack</span><span class="p">)</span>
        <span class="c1"># Store metalearner model to disk</span>
        <span class="n">path_metalearner</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_model_dir</span><span class="p">,</span>
                                        <span class="s2">&quot;metalearner.model.pickle&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ml_model</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">path_metalearner</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
<footer class="md-footer">
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021 - 2024 University of Augsburg
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/frankkramer-lab/aucmedi" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/aucmedi/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/frankkramer-lab/aucmedi/pkgs/container/aucmedi" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://zenodo.org/record/6633540" target="_blank" rel="noopener" title="zenodo.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M96 0C43 0 0 43 0 96v320c0 53 43 96 96 96h320c17.7 0 32-14.3 32-32s-14.3-32-32-32v-64c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H96m0 384h256v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32m32-240c0-8.8 7.2-16 16-16h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16m16 48h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "navigation.tabs", "navigation.indexes", "navigation.top"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>